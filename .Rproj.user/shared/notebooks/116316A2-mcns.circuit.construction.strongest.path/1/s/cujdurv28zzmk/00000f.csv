"0","fetch_connectivity <- function(synapse_threshold = 5) {"
"0","  mba <- mcns_body_annotations()%>%"
"0","    mutate(type=coalesce(type,flywire_type,manc_type,hemibrain_type))%>%"
"0","    mutate(cachero.type = str_extract(synonyms, ""(?<=Cachero 2010:)[^;]+"") %>%"
"0","                            str_trim())"
"0","  connectivity <- cf_partners(cf_ids(malecns = mba %>% pull(bodyid)),"
"0","                              partners = 'o',"
"0","                              threshold = synapse_threshold)"
"0","  connectivity <- connectivity %>%"
"0","    left_join(mba %>%"
"0","                select(""type"", ""bodyid"",'fru_dsx','consensus_nt','flywire_type','synonyms','receptor_type','cachero.type','dimorphism') %>%"
"0","                mutate(bodyid=as.integer(bodyid))%>%"
"0","                rename(pre_type = type,pre_fru_dsx=fru_dsx,pre_nt=consensus_nt,pre_fw_type=flywire_type,pre_synonyms=synonyms,pre_receptor_type=receptor_type,pre.dimorphism=dimorphism,pre.cachero.type=cachero.type),"
"0","              by = c('pre_id'='bodyid'))%>%"
"0","    rename(post_type = type)%>%"
"0","    left_join(mba %>%"
"0","                select(""bodyid"",'fru_dsx','consensus_nt','flywire_type','synonyms','receptor_type','cachero.type','dimorphism') %>%"
"0","                mutate(bodyid=as.integer(bodyid))%>%"
"0","                rename(post_fru_dsx=fru_dsx,post_nt=consensus_nt,post_fw_type=flywire_type,post_synonyms=synonyms,post_receptor_type=receptor_type,post.dimorphism=dimorphism,post.cachero.type=cachero.type),"
"0","              by = c('post_id'='bodyid'))"
"0","  return(connectivity)"
"0","}"
